{"version":3,"sources":["component/Share/Creator.js","component/Share/SharedFolder.js"],"names":["useStyles","makeStyles","theme","boxHeader","textAlign","padding","avatar","backgroundColor","palette","secondary","main","margin","width","height","shareDes","marginTop","shareInfo","color","text","disabled","fontSize","Creator","props","classes","className","alt","share","creator","nick","src","key","variant","isFolder","views","downloads","expire","Math","round","create_date","ReadMe","React","lazy","SharedFolderComponent","state","handleClickAway","pathHelper","isMobile","setSelectedTarget","window","this","readmeShowed","id","anchorEl","undefined","layout","onClickAway","managerContainer","isShare","fileList","map","value","name","toLowerCase","file","open","onClose","setShareUserPopover","anchorOrigin","vertical","horizontal","transformOrigin","Component","SharedFolder","connect","viewUpdate","shareUserPopoverAnchorEl","explorer","dispatch","toggleSnackbar","msg","openMusicDialog","targets","showImgPreivew","first","openResave","openResaveDialog","e","withStyles","marginBottom","marginLeft","spacing","marginRight","breakpoints","up","down","overflowY","withRouter"],"mappings":"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","file":"static/js/5.aea27239.chunk.js","sourcesContent":["import React from \"react\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport {Avatar, Typography} from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme=>({\n    boxHeader: {\n        textAlign: \"center\",\n        padding: 24\n    },\n    avatar: {\n        backgroundColor: theme.palette.secondary.main,\n        margin: \"0 auto\",\n        width: 50,\n        height: 50\n    },\n    shareDes: {\n        marginTop: 12\n    },\n    shareInfo: {\n        color: theme.palette.text.disabled,\n        fontSize: 14\n    },\n}));\n\nexport default function Creator(props) {\n    const classes = useStyles();\n\n    const getSecondDes = () => {\n        if (props.share.expire > 0) {\n            if (props.share.expire >= 24 * 3600) {\n                return (\n                    Math.round(props.share.expire / (24 * 3600)) +\n                    \" 天后到期\"\n                );\n            }\n            return Math.round(props.share.expire / 3600) + \" 小时后到期\";\n        }\n        return props.share.create_date;\n    };\n\n    return (\n        <div className={classes.boxHeader}>\n            <Avatar\n                className={classes.avatar}\n                alt={props.share.creator.nick}\n                src={\n                    \"/api/v3/user/avatar/\"+props.share.creator.key + \"/l\"\n                }\n            />\n            <Typography\n                variant=\"h6\"\n                className={classes.shareDes}\n            >\n                {props.isFolder&&<>此分享由 {props.share.creator.nick} 创建</>}\n                {!props.isFolder&&<> {props.share.creator.nick} 向您分享了 1 个文件</>}\n            </Typography>\n            <Typography className={classes.shareInfo}>\n                {props.share.views} 次浏览 •{\" \"}\n                {props.share.downloads} 次下载 •{\" \"}\n                {getSecondDes()}\n            </Typography>\n        </div>\n    )\n}","import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n    openMusicDialog,\n    openResaveDialog,\n    setSelectedTarget,\n    setShareUserPopover,\n    showImgPreivew,\n    toggleSnackbar\n} from \"../../actions\";\nimport { withStyles, Typography } from \"@material-ui/core\";\nimport Auth from \"../../middleware/Auth\";\nimport { withRouter } from \"react-router-dom\";\nimport FileManager from \"../FileManager/FileManager\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Popover from \"@material-ui/core/Popover\";\nimport Creator from \"./Creator\";\nimport ClickAwayListener from \"@material-ui/core/ClickAwayListener\";\nimport pathHelper from \"../../untils/page\";\nconst styles = theme => ({\n    layout: {\n        width: \"auto\",\n        marginTop: 30,\n        marginBottom: 30,\n        marginLeft: theme.spacing(3),\n        marginRight: theme.spacing(3),\n        [theme.breakpoints.up(1100 + theme.spacing(3) * 2)]: {\n            width: 1100,\n            marginLeft: \"auto\",\n            marginRight: \"auto\"\n        },\n        [theme.breakpoints.down(\"sm\")]: {\n            marginTop: theme.spacing(2),\n            marginLeft: theme.spacing(1),\n            marginRight: theme.spacing(1),\n        }\n    },\n    managerContainer:{\n        overflowY: \"auto\",\n    },\n});\n\nconst ReadMe = React.lazy(() => import(\"./ReadMe\"));\n\nconst mapStateToProps = state => {\n    return {\n        anchorEl: state.viewUpdate.shareUserPopoverAnchorEl,\n        fileList: state.explorer.fileList\n    };\n};\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        toggleSnackbar: (vertical, horizontal, msg, color) => {\n            dispatch(toggleSnackbar(vertical, horizontal, msg, color));\n        },\n        openMusicDialog: () => {\n            dispatch(openMusicDialog());\n        },\n        setSelectedTarget: targets => {\n            dispatch(setSelectedTarget(targets));\n        },\n        showImgPreivew: first => {\n            dispatch(showImgPreivew(first));\n        },\n        openResave: key => {\n            dispatch(openResaveDialog(key));\n        },\n        setShareUserPopover: e => {\n            dispatch(setShareUserPopover(e));\n        }\n    };\n};\n\nclass SharedFolderComponent extends Component {\n    state = {};\n\n    componentWillMount() {\n        window.shareInfo = this.props.share;\n    }\n\n    componentWillUnmount() {\n        window.shareInfo = null;\n        this.props.setSelectedTarget([]);\n    }\n\n    handleClickAway = () => {\n        if (!pathHelper.isMobile()){\n            this.props.setSelectedTarget([]);\n        }\n\n    };\n\n    render() {\n        const { classes } = this.props;\n        let readmeShowed = false;\n        const id = this.props.anchorEl !== null ? \"simple-popover\" : undefined;\n\n        return (\n            <div className={classes.layout}>\n                <ClickAwayListener onClickAway={this.handleClickAway}>\n                    <Paper className={classes.managerContainer}>\n                        <FileManager isShare share={this.props.share} />\n                    </Paper>\n                </ClickAwayListener>\n                { /* eslint-disable-next-line */}\n                {this.props.fileList.map(value => {\n                    if (\n                        (value.name.toLowerCase() === \"readme.md\" ||\n                            value.name.toLowerCase() === \"readme.txt\") &&\n                        !readmeShowed\n                    ) {\n                        readmeShowed = true;\n                        return <ReadMe share={this.props.share} file={value} />;\n                    }\n                })}\n                <Popover\n                    id={id}\n                    open={this.props.anchorEl !== null}\n                    anchorEl={this.props.anchorEl}\n                    onClose={() => this.props.setShareUserPopover(null)}\n                    anchorOrigin={{\n                        vertical: \"bottom\",\n                        horizontal: \"center\"\n                    }}\n                    transformOrigin={{\n                        vertical: \"top\",\n                        horizontal: \"center\"\n                    }}\n                >\n                    <Typography>\n                        <Creator isFolder share={this.props.share} />\n                    </Typography>\n                </Popover>\n            </div>\n        );\n    }\n}\n\nconst SharedFolder = connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withStyles(styles)(withRouter(SharedFolderComponent)));\n\nexport default SharedFolder;\n"],"sourceRoot":""}